// /backend/controllers/executeController.js
const { exec } = require('child_process');

exports.executeCode = (req, res) => {
  const { code } = req.body;

  // Save the code to a temporary file
  const tempFile = path.join(__dirname, '../temp', 'temp_script.py');
  fs.writeFileSync(tempFile, code);

  // Execute the Python script
  exec(`python ${tempFile}`, (error, stdout, stderr) => {
    if (error) {
      res.status(500).json({
        error: 'Error executing code',
        details: error.message
      });
    } else {
      res.status(200).json({
        message: 'Code executed successfully',
        output: stdout,
        error: stderr
      });
    }

    // Clean up the temporary file
    fs.unlinkSync(tempFile);
  });
};
